-- Data load script for fleximart_dw (PostgreSQL)
-- Source data taken from raw CSVs in ./data

-- Load dim_date (all unique dates from sales_raw Jan-Apr 2024)
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES
(20240115, '2024-01-15', 'Monday', 15, 1, 'January', 'Q1', 2024, FALSE),
(20240116, '2024-01-16', 'Tuesday', 16, 1, 'January', 'Q1', 2024, FALSE),
(20240118, '2024-01-18', 'Thursday', 18, 1, 'January', 'Q1', 2024, FALSE),
(20240120, '2024-01-20', 'Saturday', 20, 1, 'January', 'Q1', 2024, TRUE),
(20240122, '2024-01-22', 'Monday', 22, 1, 'January', 'Q1', 2024, FALSE),
(20240123, '2024-01-23', 'Tuesday', 23, 1, 'January', 'Q1', 2024, FALSE),
(20240125, '2024-01-25', 'Thursday', 25, 1, 'January', 'Q1', 2024, FALSE),
(20240128, '2024-01-28', 'Sunday', 28, 1, 'January', 'Q1', 2024, TRUE),
(20240201, '2024-02-01', 'Thursday', 1, 2, 'February', 'Q1', 2024, FALSE),
(20240202, '2024-02-02', 'Friday', 2, 2, 'February', 'Q1', 2024, FALSE),
(20240205, '2024-02-05', 'Monday', 5, 2, 'February', 'Q1', 2024, FALSE),
(20240208, '2024-02-08', 'Thursday', 8, 2, 'February', 'Q1', 2024, FALSE),
(20240210, '2024-02-10', 'Saturday', 10, 2, 'February', 'Q1', 2024, TRUE),
(20240212, '2024-02-12', 'Monday', 12, 2, 'February', 'Q1', 2024, FALSE),
(20240215, '2024-02-15', 'Thursday', 15, 2, 'February', 'Q1', 2024, FALSE),
(20240218, '2024-02-18', 'Sunday', 18, 2, 'February', 'Q1', 2024, TRUE),
(20240220, '2024-02-20', 'Tuesday', 20, 2, 'February', 'Q1', 2024, FALSE),
(20240222, '2024-02-22', 'Thursday', 22, 2, 'February', 'Q1', 2024, FALSE),
(20240225, '2024-02-25', 'Sunday', 25, 2, 'February', 'Q1', 2024, TRUE),
(20240228, '2024-02-28', 'Wednesday', 28, 2, 'February', 'Q1', 2024, FALSE),
(20240301, '2024-03-01', 'Friday', 1, 3, 'March', 'Q1', 2024, FALSE),
(20240302, '2024-03-02', 'Saturday', 2, 3, 'March', 'Q1', 2024, TRUE),
(20240305, '2024-03-05', 'Tuesday', 5, 3, 'March', 'Q1', 2024, FALSE),
(20240308, '2024-03-08', 'Friday', 8, 3, 'March', 'Q1', 2024, FALSE),
(20240310, '2024-03-10', 'Sunday', 10, 3, 'March', 'Q1', 2024, TRUE),
(20240312, '2024-03-12', 'Tuesday', 12, 3, 'March', 'Q1', 2024, FALSE),
(20240315, '2024-03-15', 'Friday', 15, 3, 'March', 'Q1', 2024, FALSE),
(20240318, '2024-03-18', 'Monday', 18, 3, 'March', 'Q1', 2024, FALSE),
(20240320, '2024-03-20', 'Wednesday', 20, 3, 'March', 'Q1', 2024, FALSE),
(20240322, '2024-03-22', 'Friday', 22, 3, 'March', 'Q1', 2024, FALSE),
(20240325, '2024-03-25', 'Monday', 25, 3, 'March', 'Q1', 2024, FALSE),
(20240328, '2024-03-28', 'Thursday', 28, 3, 'March', 'Q1', 2024, FALSE),
(20240330, '2024-03-30', 'Saturday', 30, 3, 'March', 'Q1', 2024, TRUE),
(20240401, '2024-04-01', 'Monday', 1, 4, 'April', 'Q2', 2024, FALSE),
(20240403, '2024-04-03', 'Wednesday', 3, 4, 'April', 'Q2', 2024, FALSE),
(20240405, '2024-04-05', 'Friday', 5, 4, 'April', 'Q2', 2024, FALSE),
(20240408, '2024-04-08', 'Monday', 8, 4, 'April', 'Q2', 2024, FALSE),
(20240410, '2024-04-10', 'Wednesday', 10, 4, 'April', 'Q2', 2024, FALSE),
(20240412, '2024-04-12', 'Friday', 12, 4, 'April', 'Q2', 2024, FALSE);


-- Load dim_product (from products_raw.csv)
INSERT INTO dim_product (product_key, product_id, product_name, category, subcategory, unit_price) VALUES
(1, 'P001', 'Samsung Galaxy S21', 'Electronics', NULL, 45999.00),
(2, 'P002', 'Nike Running Shoes', 'fashion', NULL, 3499.00),
(3, 'P003', 'Apple MacBook Pro', 'ELECTRONICS', NULL, NULL),
(4, 'P004', 'Levi''s Jeans', 'Fashion', NULL, 2999.00),
(5, 'P005', 'Sony Headphones', 'electronics', NULL, 1999.00),
(6, 'P006', 'Organic Almonds', 'Groceries', NULL, 899.00),
(7, 'P007', 'HP Laptop', 'Electronics', NULL, 52999.00),
(8, 'P008', 'Adidas T-Shirt', 'FASHION', NULL, 1299.00),
(9, 'P009', 'Basmati Rice 5kg', 'groceries', NULL, 650.00),
(10, 'P010', 'OnePlus Nord', 'Electronics', NULL, NULL),
(11, 'P011', 'Puma Sneakers', 'Fashion', NULL, 4599.00),
(12, 'P012', 'Dell Monitor 24inch', 'Electronics', NULL, 12999.00),
(13, 'P013', 'Woodland Shoes', 'fashion', NULL, 5499.00),
(14, 'P014', 'iPhone 13', 'Electronics', NULL, 69999.00),
(15, 'P015', 'Organic Honey 500g', 'Groceries', NULL, 450.00),
(16, 'P016', 'Samsung TV 43inch', 'ELECTRONICS', NULL, 32999.00),
(17, 'P017', 'H&M Shirt', 'Fashion', NULL, NULL),
(18, 'P018', 'Masoor Dal 1kg', 'groceries', NULL, 120.00),
(19, 'P019', 'Boat Earbuds', 'Electronics', NULL, 1499.00),
(20, 'P020', 'Reebok Trackpants', 'FASHION', NULL, 1899.00),
(21, 'UNKNOWN', 'Unknown Product', 'Unknown', NULL, NULL);


-- Load dim_customer (from customers_raw.csv)
INSERT INTO dim_customer (customer_key, customer_id, customer_name, city, state, customer_segment) VALUES
(1, 'C001', 'Rahul Sharma', 'Bangalore', NULL, NULL),
(2, 'C002', 'Priya Patel', 'Mumbai', NULL, NULL),
(3, 'C003', 'Amit Kumar', 'Delhi', NULL, NULL),
(4, 'C004', 'Sneha Reddy', 'Hyderabad', NULL, NULL),
(5, 'C005', 'Vikram Singh', 'Chennai', NULL, NULL),
(6, 'C006', 'Anjali Mehta', 'Bangalore', NULL, NULL),
(7, 'C007', 'Ravi Verma', 'Pune', NULL, NULL),
(8, 'C008', 'Pooja Iyer', 'Bangalore', NULL, NULL),
(9, 'C009', 'Karthik Nair', 'Kochi', NULL, NULL),
(10, 'C010', 'Deepa Gupta', 'Delhi', NULL, NULL),
(11, 'C011', 'Arjun Rao', 'Hyderabad', NULL, NULL),
(12, 'C012', 'Lakshmi Krishnan', 'Chennai', NULL, NULL),
(13, 'C013', 'Suresh Patel', 'Mumbai', NULL, NULL),
(14, 'C014', 'Neha Shah', 'Ahmedabad', NULL, NULL),
(15, 'C015', 'Manish Joshi', 'Jaipur', NULL, NULL),
(16, 'C016', 'Divya Menon', 'Bangalore', NULL, NULL),
(17, 'C017', 'Rajesh Kumar', 'Delhi', NULL, NULL),
(18, 'C018', 'Kavya Reddy', 'Hyderabad', NULL, NULL),
(19, 'C019', 'Arun Pillai', 'Kochi', NULL, NULL),
(20, 'C020', 'Swati Desai', 'Pune', NULL, NULL),
(21, 'C021', 'Nikhil Bose', 'Kolkata', NULL, NULL),
(22, 'UNKNOWN', 'Unknown Customer', 'Unknown', NULL, NULL);


-- Load fact_sales (from sales_raw.csv; maintains original order T001-T040)
INSERT INTO fact_sales (sale_key, date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES
(1, 20240115, 1, 1, 1, 45999.00, 0, 45999.00),
(2, 20240116, 4, 2, 2, 2999.00, 0, 5998.00),
(3, 20240115, 7, 3, 1, 52999.00, 0, 52999.00),
(4, 20240118, 2, 22, 1, 3499.00, 0, 3499.00),
(5, 20240120, 9, 5, 3, 650.00, 0, 1950.00),
(6, 20240122, 12, 6, 1, 12999.00, 0, 12999.00),
(7, 20240123, 5, 7, 2, 1999.00, 0, 3998.00),
(8, 20240125, 21, 8, 1, 1299.00, 0, 1299.00),
(9, 20240128, 11, 9, 1, 4599.00, 0, 4599.00),
(10, 20240201, 6, 10, 5, 899.00, 0, 4495.00),
(11, 20240202, 14, 11, 1, 69999.00, 0, 69999.00),
(12, 20240205, 3, 12, 1, 52999.00, 0, 52999.00),
(13, 20240208, 15, 13, 3, 450.00, 0, 1350.00),
(14, 20240210, 19, 14, 2, 1499.00, 0, 2998.00),
(15, 20240212, 8, 15, 3, 1299.00, 0, 3897.00),
(16, 20240215, 13, 22, 1, 5499.00, 0, 5499.00),
(17, 20240218, 16, 17, 1, 32999.00, 0, 32999.00),
(18, 20240220, 20, 18, 2, 1899.00, 0, 3798.00),
(19, 20240222, 18, 19, 10, 120.00, 0, 1200.00),
(20, 20240225, 10, 20, 1, 45999.00, 0, 45999.00),
(21, 20240228, 17, 21, 2, 2999.00, 0, 5998.00),
(22, 20240301, 1, 2, 1, 45999.00, 0, 45999.00),
(23, 20240302, 19, 3, 3, 1499.00, 0, 4497.00),
(24, 20240305, 9, 4, 5, 650.00, 0, 3250.00),
(25, 20240308, 5, 5, 1, 1999.00, 0, 1999.00),
(26, 20240310, 11, 6, 1, 4599.00, 0, 4599.00),
(27, 20240312, 2, 7, 2, 3499.00, 0, 6998.00),
(28, 20240315, 15, 8, 4, 450.00, 0, 1800.00),
(29, 20240318, 7, 9, 1, 52999.00, 0, 52999.00),
(30, 20240320, 4, 22, 3, 2999.00, 0, 8997.00),
(31, 20240322, 12, 11, 1, 12999.00, 0, 12999.00),
(32, 20240325, 16, 12, 1, 32999.00, 0, 32999.00),
(33, 20240328, 5, 13, 2, 1999.00, 0, 3998.00),
(34, 20240330, 8, 14, 2, 1299.00, 0, 2598.00),
(35, 20240401, 18, 15, 8, 120.00, 0, 960.00),
(36, 20240403, 14, 16, 1, 69999.00, 0, 69999.00),
(37, 20240405, 6, 17, 4, 899.00, 0, 3596.00),
(38, 20240408, 20, 18, 1, 1899.00, 0, 1899.00),
(39, 20240410, 19, 19, 2, 1499.00, 0, 2998.00),
(40, 20240412, 13, 20, 1, 5499.00, 0, 5499.00);
